GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/torch/cuda/__init__.py:146: UserWarning:
NVIDIA GeForce RTX 4060 Ti with CUDA capability sm_89 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70.
If you want to use the NVIDIA GeForce RTX 4060 Ti GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/
  warnings.warn(incompatible_device_warn.format(device_name, capability, " ".join(arch_list), device_name))
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name             | Type             | Params
------------------------------------------------------
0 | model            | Unet             | 24.4 M
1 | val_seg_metrics  | MetricCollection | 0
2 | test_seg_metrics | MetricCollection | 0
------------------------------------------------------
24.4 M    Trainable params
0         Non-trainable params
24.4 M    Total params
97.745    Total estimated model params size (MB)
/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:488: PossibleUserWarning: Your `val_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test/predict dataloaders.
  rank_zero_warn(
Traceback (most recent call last):
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1098, in _run
    results = self._run_stage()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1177, in _run_stage
    self._run_train()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1255, in _run_sanity_check
    val_loop._reload_evaluation_dataloaders()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 234, in _reload_evaluation_dataloaders
    self.trainer.reset_val_dataloader()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1635, in reset_val_dataloader
    self.num_val_batches, self.val_dataloaders = self._data_connector._reset_eval_dataloader(
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py", line 391, in _reset_eval_dataloader
    len(dataloader) if has_len_all_ranks(dataloader, self.trainer.strategy, module) else float("inf")
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/utilities/data.py", line 110, in has_len_all_ranks
    if total_length == 0:
RuntimeError: CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/sasha/segment_barcode/train.py", line 54, in <module>
    train(cfg, cfg_m)
  File "/home/sasha/segment_barcode/train.py", line 46, in train
    trainer.fit(model, datamodule)
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 63, in _call_and_handle_interrupt
    trainer._teardown()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1161, in _teardown
    self.strategy.teardown()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 496, in teardown
    self.lightning_module.cpu()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/lightning_lite/utilities/device_dtype_mixin.py", line 78, in cpu
    return super().cpu()
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 738, in cpu
    return self._apply(lambda t: t.cpu())
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 579, in _apply
    module._apply(fn)
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 579, in _apply
    module._apply(fn)
  File "/home/sasha/segment_barcode/venv/lib/python3.10/site-packages/torchmetrics/metric.py", line 646, in _apply
    self._device = fn(torch.zeros(1, device=self.device)).device
RuntimeError: CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Sanity Checking: 0it [00:00, ?it/s]